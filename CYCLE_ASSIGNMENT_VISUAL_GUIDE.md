# ğŸ¨ Cycle Assignment UX - Visual Guide

## ğŸ”„ FLOW DIAGRAM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ“… MENU NAVIGATION                        â”‚
â”‚  "PhÃ¢n cÃ´ng theo chu ká»³" â†’ /giao-nhiem-vu-chu-ky           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ğŸ“Š TRANG 1: CycleAssignmentListPage                 â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                             â”‚
â”‚  ğŸ”½ CHU Ká»² ÄÃNH GIÃ: [Q1/2025 â–¼]                          â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ STT â”‚ MÃ£ NV â”‚ Há» tÃªn    â”‚ Khoa      â”‚ NV   â”‚ Thao tÃ¡câ”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ 1   â”‚ NV001 â”‚ Nguyá»…n A  â”‚ Khoa Ná»™i  â”‚ 5/12 â”‚ [GÃ¡n]  â”‚ â”‚â—„â”€â”
â”‚  â”‚ 2   â”‚ NV002 â”‚ Tráº§n B    â”‚ Khoa Ná»™i  â”‚ 8/12 â”‚ [GÃ¡n]  â”‚ â”‚  â”‚
â”‚  â”‚ 3   â”‚ NV003 â”‚ LÃª C      â”‚ Khoa Ngoáº¡iâ”‚ 0/8  â”‚ [GÃ¡n]  â”‚ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚                                                             â”‚  â”‚
â”‚  ğŸ“ˆ Thá»‘ng kÃª: 15 nhÃ¢n viÃªn | 8 Ä‘Ã£ gÃ¡n Ä‘á»§ | 2 chÆ°a gÃ¡n    â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                     â”‚ Click [GÃ¡n]                               â”‚
                     â–¼                                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚      ğŸ“ TRANG 2: CycleAssignmentDetailPage                  â”‚  â”‚
â”‚  URL: /giao-nhiem-vu-chu-ky/:NhanVienID?chuKyId=xxx        â”‚  â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚                                                             â”‚  â”‚
â”‚  ğŸ‘¤ NhÃ¢n viÃªn: Nguyá»…n VÄƒn A (NV001) - Khoa Ná»™i             â”‚  â”‚
â”‚  ğŸ”½ Chu ká»³: Q1/2025 (auto-selected from URL)              â”‚  â”‚
â”‚                                                             â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  ğŸ“š Nhiá»‡m vá»¥ (7)    â”‚  ğŸ“ ÄÃ£ gÃ¡n (5)                 â”‚ â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚
â”‚  â”‚                     â”‚                                 â”‚ â”‚  â”‚
â”‚  â”‚ â˜ Nhiá»‡m vá»¥ 1 [+]   â”‚ 1. Nhiá»‡m vá»¥ A                  â”‚ â”‚  â”‚
â”‚  â”‚ â˜ Nhiá»‡m vá»¥ 2 [+]   â”‚    Äá»™ khÃ³: [5.0] ğŸŸ¡        [X]â”‚ â”‚  â”‚
â”‚  â”‚ â˜ Nhiá»‡m vá»¥ 3 [+]   â”‚                                 â”‚ â”‚  â”‚
â”‚  â”‚ â˜ Nhiá»‡m vá»¥ 4 [+]   â”‚ 2. Nhiá»‡m vá»¥ B                  â”‚ â”‚  â”‚
â”‚  â”‚ â˜ Nhiá»‡m vá»¥ 5 [+]   â”‚    Äá»™ khÃ³: [7.0] ğŸ”´        [X]â”‚ â”‚  â”‚
â”‚  â”‚ â˜ Nhiá»‡m vá»¥ 6 [+]   â”‚                                 â”‚ â”‚  â”‚
â”‚  â”‚ â˜ Nhiá»‡m vá»¥ 7 [+]   â”‚ ... (3 more)                   â”‚ â”‚  â”‚
â”‚  â”‚                     â”‚                                 â”‚ â”‚  â”‚
â”‚  â”‚                     â”‚ Tá»•ng: 5 nhiá»‡m vá»¥ | Äá»™ khÃ³: 31.5â”‚ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚                                                             â”‚  â”‚
â”‚  [â† Quay láº¡i]                           [ğŸ’¾ LÆ°u thay Ä‘á»•i] â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                     â”‚ Click [Quay láº¡i]                          â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ USER INTERACTION POINTS

### 1ï¸âƒ£ **Entry Point (Menu)**

```
Menu sidebar
  â””â”€ Quáº£n lÃ½ cÃ´ng viá»‡c
      â””â”€ ğŸ“… PhÃ¢n cÃ´ng theo chu ká»³  â† Click here
```

### 2ï¸âƒ£ **List Page (Overview)**

```
Actions:
1. Select cycle from dropdown
   â†’ Triggers API call
   â†’ Loads employee table

2. View employee stats
   â†’ Color-coded progress chips:
      ğŸ”´ 0%    = No assignments
      ğŸŸ¡ 1-49% = Partially assigned
      ğŸ”µ 50-99%= In progress
      ğŸŸ¢ 100%  = Fully assigned

3. Click [GÃ¡n] button
   â†’ Navigate to detail page
   â†’ Passes chuKyId via URL query param
```

### 3ï¸âƒ£ **Detail Page (Assignment)**

```
Actions:
1. Auto-load cycle from URL
   â†’ No need to re-select cycle

2. Left column: Add tasks
   â†’ Click [+] button
   â†’ Task moves to right column

3. Right column: Edit/Remove
   â†’ Adjust difficulty (1.0-10.0)
   â†’ Click [X] to remove

4. [LÆ°u thay Ä‘á»•i]
   â†’ Batch save all changes
   â†’ Updates database

5. [Quay láº¡i]
   â†’ Return to list page
   â†’ Stats automatically refresh
```

---

## ğŸ“Š DATA FLOW

### API Call Sequence

#### **Page Load: ListPage**

```
1. GET /chu-ky-danh-gia
   â†’ Load cycles dropdown

2. User selects cycle

3. GET /employees-with-cycle-stats?chuKyId=xxx
   â†“
   Response: [
     {
       employee: { _id, Ten, MaNhanVien, KhoaID },
       assignedCount: 5,
       totalDuties: 12,
       LoaiQuanLy: "KPI"
     },
     ...
   ]
   â†“
4. Render table with stats
```

#### **Page Load: DetailPage**

```
1. Read chuKyId from URL: ?chuKyId=xxx

2. GET /chu-ky-danh-gia
   â†’ Load cycles dropdown

3. Auto-dispatch: setSelectedChuKy(chuKyId)

4. GET /nhan-vien/:employeeId/by-cycle?chuKyId=xxx
   â†“
   Response: {
     employee: {...},
     assignedTasks: [...],
     availableDuties: [...]
   }
   â†“
5. Render two-column layout
```

#### **Save Changes**

```
1. User clicks [LÆ°u thay Ä‘á»•i]

2. PUT /nhan-vien/:employeeId/cycle-assignments
   Body: {
     chuKyId: "xxx",
     tasks: [
       { NhiemVuThuongQuyID: "...", MucDoKho: 5.0 },
       { NhiemVuThuongQuyID: "...", MucDoKho: 7.0 }
     ]
   }
   â†“
3. Backend: Hard delete old + Insert new

4. Success toast: "ÄÃ£ lÆ°u thÃ nh cÃ´ng"

5. Redux state updates
```

---

## ğŸ¨ UI COMPONENTS

### Color Palette

#### Progress Chips

```css
ğŸ”´ error   (0%):       background: #f44336
ğŸŸ¡ warning (1-49%):    background: #ff9800
ğŸ”µ info    (50-99%):   background: #2196f3
ğŸŸ¢ success (100%):     background: #4caf50
```

#### Management Type Chips

```css
[KPI]        â†’ primary   (blue)
[Giao viá»‡c]  â†’ default   (gray)
```

#### Difficulty Chips (Detail Page)

```css
1.0-3.0  â†’ success  (green)   Easy
3.5-7.0  â†’ warning  (orange)  Medium
7.5-10.0 â†’ error    (red)     Hard
```

---

## ğŸ“± RESPONSIVE BEHAVIOR

### Desktop (â‰¥1200px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Full table with all columns                â”‚
â”‚ Two-column layout side-by-side            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tablet (768-1199px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Table with wrapped cells â”‚
â”‚ Two columns stacked      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mobile (<768px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Card layout  â”‚
â”‚ for table    â”‚
â”‚              â”‚
â”‚ Single columnâ”‚
â”‚ for tasks    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”’ PERMISSIONS

### Role-Based Access

```javascript
// Backend checks:
1. User must be logged in
2. User must have NhanVienID
3. For ListPage: Returns only employees where:
   - QuanLyNhanVien.NhanVienQuanLy = current user
   - LoaiQuanLy in ["KPI", "Giao_Viec"]

4. For DetailPage: Validates:
   - Current user manages target employee
   - OR user is admin (bypass)
```

### Admin Override

```javascript
if (user.PhanQuyen === "admin") {
  // Can view/edit all employees
  // Can access any cycle
}
```

---

## âš¡ PERFORMANCE

### Optimization Strategies

1. **Lazy Loading**

   - Cycles loaded once on mount
   - Employees loaded per cycle selection

2. **Memoization** (Future)

   - Cache employee stats per cycle
   - Invalidate on assignment save

3. **Pagination** (Future)

   - If >50 employees, paginate table
   - Keep all on same page for now

4. **Debouncing** (Future)
   - Debounce cycle selector
   - Prevent multiple API calls

---

## ğŸ› ERROR HANDLING

### Scenario Matrix

| Scenario               | Behavior                      |
| ---------------------- | ----------------------------- |
| No cycles in DB        | Empty dropdown + info message |
| No managed employees   | Empty table + warning alert   |
| API timeout            | Toast error + retry button    |
| Invalid chuKyId in URL | Ignore + show cycle selector  |
| Missing permissions    | 403 error + redirect to home  |

---

## ğŸ“ USER GUIDE SUMMARY

### Quick Start (3 Steps)

```
1. Menu â†’ "ğŸ“… PhÃ¢n cÃ´ng theo chu ká»³"
2. Chá»n chu ká»³ tá»« dropdown
3. Click [GÃ¡n] trÃªn nhÃ¢n viÃªn cáº§n phÃ¢n cÃ´ng
```

### Advanced Features

- **Copy tá»« chu ká»³ trÆ°á»›c:** Dropdown in detail page
- **Äiá»u chá»‰nh Ä‘á»™ khÃ³:** TextField vá»›i bÆ°á»›c 0.5
- **XÃ³a nhiá»‡m vá»¥:** Click icon [X] bÃªn pháº£i
- **LÆ°u hÃ ng loáº¡t:** Táº¥t cáº£ thay Ä‘á»•i lÆ°u cÃ¹ng lÃºc

---

## ğŸ“š KEYBOARD SHORTCUTS (Future Enhancement)

```
Ctrl + S  â†’ Save changes (detail page)
Escape    â†’ Go back to list
Enter     â†’ Confirm cycle selection
â†‘/â†“       â†’ Navigate table rows
Space     â†’ Toggle task selection
```

---

**Visual Guide Version:** 1.0  
**Last Updated:** October 18, 2025
