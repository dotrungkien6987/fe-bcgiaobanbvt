# Phase 2 UI/UX - Y√™u C·∫ßu & KPI Dashboards

**Part 4 of 5**  
**Screens:** YeuCauDashboardPage + KPIDashboardPage  
**Type:** New Pages  
**Effort:** 6h (3h + 3h)  
**Status:** ‚ùå Need to Create

---

## üì± Screen 1: YeuCauDashboardPage

### Layout (Mobile)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚Üê Y√™u C·∫ßu                      [+ T·∫°o] [‚ãÆ]     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                ‚îÇ
‚îÇ  üì§ Y√äU C·∫¶U T√îI G·ª¨I (6)           [Xem t·∫•t c·∫£ ‚Üí]‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ   M·ªõi    ‚îÇ ‚îÇƒêang x·ª≠ l√Ω‚îÇ ‚îÇHo√†n th√†nh‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ    2     ‚îÇ ‚îÇ    3     ‚îÇ ‚îÇ    1     ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ  ‚ö†Ô∏è C·∫¶N X·ª¨ L√ù (4)                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ üî¥ YC-001: Y√™u c·∫ßu b√°o c√°o   [Qu√° h·∫°n]   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ üü† YC-015: Xin t√†i li·ªáu      [1 ng√†y]    ‚îÇ ‚îÇ
‚îÇ  ‚îÇ üü° YC-023: H·ªó tr·ª£ k·ªπ thu·∫≠t   [2 ng√†y]    ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ  üë• ƒêI·ªÄU PH·ªêI (2) [Manager only]              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ Ch·ªù ph√¢n ‚îÇ ‚îÇƒêang x·ª≠ l√Ω‚îÇ              ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ    1     ‚îÇ ‚îÇ    1     ‚îÇ              ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ  üìã QU·∫¢N L√ù KHOA (8) [Admin only]             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  T·ªïng y√™u c·∫ßu: 8                         ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  Ch·ªù ph√™ duy·ªát: 3                        ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  [Xem chi ti·∫øt ‚Üí]                        ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üóÇÔ∏è Files: YeuCauDashboardPage

### Frontend Files

```
fe-bcgiaobanbvt/src/features/QuanLyCongViec/
‚îú‚îÄ Dashboard/
‚îÇ  ‚îú‚îÄ YeuCauDashboardPage.js              [CREATE] ‚ùå
‚îÇ  ‚îî‚îÄ components/
‚îÇ     ‚îú‚îÄ YeuCauSentSection.js             [CREATE] ‚ùå
‚îÇ     ‚îú‚îÄ YeuCauNeedActionSection.js       [CREATE] ‚ùå
‚îÇ     ‚îú‚îÄ YeuCauManagerSection.js          [CREATE] ‚ùå
‚îÇ     ‚îî‚îÄ YeuCauAdminSection.js            [CREATE] ‚ùå
‚îÇ
‚îî‚îÄ Ticket/
   ‚îî‚îÄ yeuCauSlice.js                      [REUSE] ‚úÖ
      ‚îî‚îÄ getBadgeCounts()                 [EXISTING]
```

### Backend Files

```
giaobanbv-be/modules/workmanagement/
‚îî‚îÄ routes/
   ‚îî‚îÄ yeucau.api.js                       [VERIFY] ‚ö†Ô∏è
      ‚îî‚îÄ GET /yeucau/badge-counts-page    [VERIFY NAME]
```

---

## üé® YeuCauDashboardPage Component

**File:** `Dashboard/YeuCauDashboardPage.js` [CREATE]

```javascript
import React, { useEffect } from "react";
import { useNavigate } from "react-router-dom";
import { useDispatch, useSelector } from "react-redux";
import { Container, Stack, Typography, Button, Box } from "@mui/material";
import { Add } from "iconsax-react";
import useAuth from "hooks/useAuth";
import {
  getBadgeCounts,
  selectBadgeCounts,
  selectYeuCauLoading,
} from "../Ticket/yeuCauSlice";
import YeuCauSentSection from "./components/YeuCauSentSection";
import YeuCauNeedActionSection from "./components/YeuCauNeedActionSection";
import YeuCauManagerSection from "./components/YeuCauManagerSection";
import YeuCauAdminSection from "./components/YeuCauAdminSection";

const YeuCauDashboardPage = () => {
  const navigate = useNavigate();
  const dispatch = useDispatch();
  const { user } = useAuth();

  const badgeCounts = useSelector(selectBadgeCounts);
  const isLoading = useSelector(selectYeuCauLoading);

  const isManager = ["manager", "admin"].includes(user?.PhanQuyen);
  const isAdmin = user?.PhanQuyen === "admin";

  // Fetch badge counts for all pages
  useEffect(() => {
    const pageKeys = [
      "YEU_CAU_TOI_GUI",
      "YEU_CAU_TOI_XU_LY",
      ...(isManager ? ["YEU_CAU_DIEU_PHOI"] : []),
      ...(isAdmin ? ["YEU_CAU_QUAN_LY_KHOA"] : []),
    ];

    pageKeys.forEach((key) => {
      dispatch(getBadgeCounts(key));
    });
  }, [dispatch, isManager, isAdmin]);

  const handleCreate = () => {
    navigate("/quanlycongviec/yeucau/tao-moi");
  };

  return (
    <Container maxWidth="lg" sx={{ pb: 10 }}>
      <Stack spacing={3}>
        {/* Header */}
        <Box display="flex" justifyContent="space-between" alignItems="center">
          <Typography variant="h5" fontWeight={600}>
            üìù Y√™u C·∫ßu
          </Typography>
          <Button
            variant="contained"
            startIcon={<Add />}
            onClick={handleCreate}
          >
            T·∫°o m·ªõi
          </Button>
        </Box>

        {/* Sent Section (All users) */}
        <YeuCauSentSection
          data={badgeCounts["YEU_CAU_TOI_GUI"]}
          onNavigate={() => navigate("/quanlycongviec/yeucau-toi-gui")}
        />

        {/* Need Action Section (All users) */}
        <YeuCauNeedActionSection
          data={badgeCounts["YEU_CAU_TOI_XU_LY"]}
          onNavigate={() => navigate("/quanlycongviec/yeucau-xu-ly")}
        />

        {/* Manager Section (Conditional) */}
        {isManager && (
          <YeuCauManagerSection
            data={badgeCounts["YEU_CAU_DIEU_PHOI"]}
            onNavigate={() => navigate("/quanlycongviec/yeucau-dieu-phoi")}
          />
        )}

        {/* Admin Section (Conditional) */}
        {isAdmin && (
          <YeuCauAdminSection
            data={badgeCounts["YEU_CAU_QUAN_LY_KHOA"]}
            onNavigate={() => navigate("/quanlycongviec/yeucau-quan-ly-khoa")}
          />
        )}
      </Stack>
    </Container>
  );
};

export default YeuCauDashboardPage;
```

**Estimated Lines:** ~150 lines

---

### YeuCauNeedActionSection (Priority List)

**File:** `Dashboard/components/YeuCauNeedActionSection.js` [CREATE]

```javascript
import React from "react";
import {
  Card,
  CardContent,
  Typography,
  Stack,
  Box,
  Chip,
  Button,
} from "@mui/material";
import { useNavigate } from "react-router-dom";

const YeuCauNeedActionSection = ({ data, onNavigate }) => {
  const navigate = useNavigate();

  // Assume data includes priority items (can fetch separately if needed)
  const priorityItems = data?.priorityItems || [];

  return (
    <Card>
      <CardContent>
        <Box
          display="flex"
          justifyContent="space-between"
          alignItems="center"
          mb={2}
        >
          <Typography variant="h6">
            ‚ö†Ô∏è C·∫¶N X·ª¨ L√ù ({data?.total || 0})
          </Typography>
          <Button size="small" onClick={onNavigate}>
            Xem t·∫•t c·∫£ ‚Üí
          </Button>
        </Box>

        <Stack spacing={1.5}>
          {priorityItems.slice(0, 3).map((item) => (
            <Box
              key={item._id}
              sx={{
                p: 1.5,
                borderRadius: 1,
                bgcolor: "warning.lighter",
                cursor: "pointer",
                "&:hover": { bgcolor: "warning.light" },
              }}
              onClick={() => navigate(`/yeucau/detail/${item._id}`)}
            >
              <Stack direction="row" alignItems="center" spacing={2}>
                <Typography variant="body2" fontWeight={600} flex={1}>
                  {item.TieuDe}
                </Typography>
                <Chip
                  label={item.deadlineText || "C·∫ßn x·ª≠ l√Ω"}
                  size="small"
                  color="warning"
                />
              </Stack>
            </Box>
          ))}

          {priorityItems.length === 0 && (
            <Typography variant="body2" color="text.secondary" align="center">
              Kh√¥ng c√≥ y√™u c·∫ßu c·∫ßn x·ª≠ l√Ω
            </Typography>
          )}
        </Stack>
      </CardContent>
    </Card>
  );
};

export default YeuCauNeedActionSection;
```

---

## üì± Screen 2: KPIDashboardPage

### Layout (Mobile - Employee View)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚Üê ƒê√°nh Gi√° KPI           [L·ªãch s·ª≠ ‚ñº] [‚ãÆ]      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                ‚îÇ
‚îÇ  üéØ CHU K·ª≤ HI·ªÜN T·∫†I                [ƒê·ªïi chu k·ª≥]‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  üìÖ Th√°ng 01/2026                        ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  T·ª´ 01/01 ‚Üí 31/01                        ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ  üìä TI·∫æN ƒê·ªò C·ª¶A T√îI                           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ                                          ‚îÇ ‚îÇ
‚îÇ  ‚îÇ     ƒêi·ªÉm hi·ªán t·∫°i: 85/100               ‚îÇ ‚îÇ
‚îÇ  ‚îÇ     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ñë‚ñë‚ñë‚ñë 85%              ‚îÇ ‚îÇ
‚îÇ  ‚îÇ                                          ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚úÖ ƒê√£ duy·ªát: 8/12 nhi·ªám v·ª•             ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚è≥ Ch·ªù ƒë√°nh gi√°: 3 nhi·ªám v·ª•            ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  üìù Ch∆∞a ƒë√°nh gi√°: 1 nhi·ªám v·ª•           ‚îÇ ‚îÇ
‚îÇ  ‚îÇ                                          ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  [üìù T·ª± ƒë√°nh gi√° ngay ‚Üí]                ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ  üìã NHI·ªÜM V·ª§ TH∆Ø·ªúNG QUY (12)                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ ‚úÖ NVTQ-01: B√°o c√°o tu·∫ßn       [85 ƒëi·ªÉm] ‚îÇ ‚îÇ
‚îÇ  ‚îÇ ‚úÖ NVTQ-05: Ki·ªÉm tra h·ªì s∆°     [90 ƒëi·ªÉm] ‚îÇ ‚îÇ
‚îÇ  ‚îÇ ‚è≥ NVTQ-08: H·ªçp ƒë·ªãnh k·ª≥        [Ch·ªù ƒêG] ‚îÇ ‚îÇ
‚îÇ  ‚îÇ üìù NVTQ-12: ƒê√†o t·∫°o            [Ch∆∞a ƒêG]‚îÇ ‚îÇ
‚îÇ  ‚îÇ              ... (xem t·∫•t c·∫£)            ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Layout (Manager View - Additional Section)

```
‚îÇ  üë• NH√ìM T√îI QU·∫¢N L√ù (5 ng∆∞·ªùi)    [Xem chi ti·∫øt ‚Üí]‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇHo√†n th√†nh‚îÇ ‚îÇƒêang ƒë√°nh‚îÇ ‚îÇ  Ch∆∞a    ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ    2     ‚îÇ ‚îÇ   gi√°   ‚îÇ ‚îÇb·∫Øt ƒë·∫ßu   ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ          ‚îÇ ‚îÇ    2    ‚îÇ ‚îÇ    1     ‚îÇ ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
```

---

## üóÇÔ∏è Files: KPIDashboardPage

### Frontend Files

```
fe-bcgiaobanbvt/src/features/QuanLyCongViec/
‚îú‚îÄ Dashboard/
‚îÇ  ‚îú‚îÄ KPIDashboardPage.js                 [CREATE] ‚ùå
‚îÇ  ‚îî‚îÄ components/
‚îÇ     ‚îú‚îÄ CycleSelector.js                 [CREATE] ‚ùå
‚îÇ     ‚îú‚îÄ PersonalKPIProgress.js           [CREATE] ‚ùå
‚îÇ     ‚îú‚îÄ NhiemVuList.js                   [CREATE] ‚ùå
‚îÇ     ‚îî‚îÄ TeamKPISection.js                [CREATE] ‚ùå (manager)
‚îÇ
‚îî‚îÄ KPI/
   ‚îî‚îÄ kpiSlice.js                         [REUSE] ‚úÖ
      ‚îú‚îÄ getDanhGiaKPIs()                 [EXISTING]
      ‚îî‚îÄ getNhanVienCoTheGiaoViec()       [EXISTING]
```

### Backend Files

```
giaobanbv-be/modules/workmanagement/
‚îî‚îÄ routes/
   ‚îî‚îÄ kpi.api.js                          [REUSE] ‚úÖ
      ‚îú‚îÄ GET /kpi/dashboard/:cycleId      [EXISTING]
      ‚îî‚îÄ GET /kpi/nhanvien/:nhanVienId    [EXISTING]
```

---

## üé® KPIDashboardPage Component

**File:** `Dashboard/KPIDashboardPage.js` [CREATE]

```javascript
import React, { useEffect, useState } from "react";
import { useNavigate } from "react-router-dom";
import { useDispatch, useSelector } from "react-redux";
import { Container, Stack, Typography, Box } from "@mui/material";
import useAuth from "hooks/useAuth";
import {
  getDanhGiaKPIs,
  getNhanVienCoTheGiaoViec,
  selectDanhGiaKPIs,
  selectKPILoading,
} from "../KPI/kpiSlice";
import CycleSelector from "./components/CycleSelector";
import PersonalKPIProgress from "./components/PersonalKPIProgress";
import NhiemVuList from "./components/NhiemVuList";
import TeamKPISection from "./components/TeamKPISection";

const KPIDashboardPage = () => {
  const navigate = useNavigate();
  const dispatch = useDispatch();
  const { user } = useAuth();
  const nhanVienId = user?.NhanVienID;

  const [selectedCycle, setSelectedCycle] = useState(null);

  const danhGiaKPIs = useSelector(selectDanhGiaKPIs);
  const isLoading = useSelector(selectKPILoading);

  const isManager = ["manager", "admin"].includes(user?.PhanQuyen);

  // Fetch KPI data on mount/cycle change
  useEffect(() => {
    if (nhanVienId && selectedCycle) {
      dispatch(
        getDanhGiaKPIs({
          nhanVienId,
          chuKyId: selectedCycle._id,
        })
      );
    }
  }, [dispatch, nhanVienId, selectedCycle]);

  // Fetch team data for managers
  useEffect(() => {
    if (isManager && selectedCycle) {
      dispatch(getNhanVienCoTheGiaoViec(selectedCycle._id));
    }
  }, [dispatch, isManager, selectedCycle]);

  const handleCycleChange = (cycle) => {
    setSelectedCycle(cycle);
  };

  const handleNavigateToSelfAssess = () => {
    navigate("/quanlycongviec/tu-danh-gia-kpi");
  };

  return (
    <Container maxWidth="lg" sx={{ pb: 10 }}>
      <Stack spacing={3}>
        {/* Header */}
        <Box display="flex" justifyContent="space-between" alignItems="center">
          <Typography variant="h5" fontWeight={600}>
            üèÜ ƒê√°nh Gi√° KPI
          </Typography>
          <CycleSelector value={selectedCycle} onChange={handleCycleChange} />
        </Box>

        {/* Personal Progress */}
        <PersonalKPIProgress
          data={danhGiaKPIs}
          cycleInfo={selectedCycle}
          onNavigate={handleNavigateToSelfAssess}
          isLoading={isLoading}
        />

        {/* Nhi·ªám v·ª• list */}
        <NhiemVuList
          danhGiaKPIs={danhGiaKPIs}
          onNavigate={(id) => navigate(`/quanlycongviec/xem-kpi/${id}`)}
        />

        {/* Team Section (Manager only) */}
        {isManager && (
          <TeamKPISection
            cycleId={selectedCycle?._id}
            onNavigate={() =>
              navigate(
                `/quanlycongviec/danh-gia-kpi?cycleId=${selectedCycle._id}`
              )
            }
          />
        )}
      </Stack>
    </Container>
  );
};

export default KPIDashboardPage;
```

**Estimated Lines:** ~180 lines

---

### PersonalKPIProgress Component

**File:** `Dashboard/components/PersonalKPIProgress.js` [CREATE]

```javascript
import React from "react";
import {
  Card,
  CardContent,
  Typography,
  Box,
  LinearProgress,
  Stack,
  Button,
  Chip,
  Skeleton,
} from "@mui/material";

const PersonalKPIProgress = ({ data, cycleInfo, onNavigate, isLoading }) => {
  if (isLoading) {
    return <Skeleton variant="rectangular" height={200} />;
  }

  // Calculate stats
  const total = data?.length || 0;
  const approved = data?.filter((d) => d.TrangThai === "DA_DUYET").length || 0;
  const pending = data?.filter((d) => d.TrangThai === "CHUA_DUYET").length || 0;
  const notStarted = total - approved - pending;

  // Calculate average score (only approved)
  const approvedScores = data
    ?.filter((d) => d.TrangThai === "DA_DUYET" && d.TongDiemKPI)
    .map((d) => d.TongDiemKPI);
  const avgScore =
    approvedScores?.length > 0
      ? Math.round(
          approvedScores.reduce((a, b) => a + b, 0) / approvedScores.length
        )
      : 0;

  return (
    <Card>
      <CardContent>
        <Typography variant="h6" gutterBottom>
          üìä TI·∫æN ƒê·ªò C·ª¶A T√îI
        </Typography>

        {/* Score Display */}
        <Box my={3} textAlign="center">
          <Typography variant="h3" fontWeight={700} color="primary">
            {avgScore}/100
          </Typography>
          <Typography variant="body2" color="text.secondary">
            ƒêi·ªÉm trung b√¨nh
          </Typography>

          <Box mt={2}>
            <LinearProgress
              variant="determinate"
              value={avgScore}
              sx={{ height: 10, borderRadius: 5 }}
            />
          </Box>
        </Box>

        {/* Stats */}
        <Stack direction="row" spacing={2} justifyContent="space-around">
          <Box textAlign="center">
            <Chip label={`${approved}/${total}`} color="success" />
            <Typography variant="caption" display="block" mt={0.5}>
              ƒê√£ duy·ªát
            </Typography>
          </Box>
          <Box textAlign="center">
            <Chip label={pending} color="warning" />
            <Typography variant="caption" display="block" mt={0.5}>
              Ch·ªù ƒë√°nh gi√°
            </Typography>
          </Box>
          <Box textAlign="center">
            <Chip label={notStarted} color="default" />
            <Typography variant="caption" display="block" mt={0.5}>
              Ch∆∞a ƒë√°nh gi√°
            </Typography>
          </Box>
        </Stack>

        {/* Action Button */}
        <Button
          fullWidth
          variant="contained"
          sx={{ mt: 3 }}
          onClick={onNavigate}
        >
          üìù T·ª± ƒë√°nh gi√° ngay
        </Button>
      </CardContent>
    </Card>
  );
};

export default PersonalKPIProgress;
```

---

### CycleSelector Component

**File:** `Dashboard/components/CycleSelector.js` [CREATE]

```javascript
import React, { useEffect, useState } from "react";
import {
  Select,
  MenuItem,
  FormControl,
  InputLabel,
  Box,
  Typography,
} from "@mui/material";
import apiService from "app/apiService";

const CycleSelector = ({ value, onChange }) => {
  const [cycles, setCycles] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchCycles = async () => {
      try {
        const response = await apiService.get(
          "/workmanagement/chu-ky-danh-gia"
        );
        const cycleList = response.data.data || [];
        setCycles(cycleList);

        // Auto-select current cycle
        const currentCycle = cycleList.find((c) => c.isActive) || cycleList[0];
        if (currentCycle && !value) {
          onChange(currentCycle);
        }
      } catch (error) {
        console.error("Error fetching cycles:", error);
      } finally {
        setLoading(false);
      }
    };

    fetchCycles();
  }, []);

  return (
    <FormControl size="small" sx={{ minWidth: 200 }}>
      <InputLabel>Chu k·ª≥</InputLabel>
      <Select
        value={value?._id || ""}
        onChange={(e) => {
          const selected = cycles.find((c) => c._id === e.target.value);
          onChange(selected);
        }}
        label="Chu k·ª≥"
        disabled={loading}
      >
        {cycles.map((cycle) => (
          <MenuItem key={cycle._id} value={cycle._id}>
            <Box>
              <Typography variant="body2">{cycle.TenChuKy}</Typography>
              <Typography variant="caption" color="text.secondary">
                {new Date(cycle.NgayBatDau).toLocaleDateString("vi-VN")} ‚Üí{" "}
                {new Date(cycle.NgayKetThuc).toLocaleDateString("vi-VN")}
              </Typography>
            </Box>
          </MenuItem>
        ))}
      </Select>
    </FormControl>
  );
};

export default CycleSelector;
```

---

## üîå API Integration

### YeuCau Dashboard

**Reuses existing:** `getBadgeCounts()` from `yeuCauSlice.js`

**API Call:**

```javascript
// Already implemented
GET / api / workmanagement / yeucau / badge - counts - page;
?pageKey = YEU_CAU_TOI_GUI;
```

**No new backend APIs needed** ‚úÖ

---

### KPI Dashboard

**Reuses existing:**

- `getDanhGiaKPIs()` from `kpiSlice.js`
- `getNhanVienCoTheGiaoViec()` for manager view

**API Calls:**

```javascript
// Personal KPI
GET /api/workmanagement/kpi/nhanvien/:nhanVienId?chuKyId=...

// Manager view
GET /api/workmanagement/kpi/dashboard/:cycleId
```

**No new backend APIs needed** ‚úÖ

---

## üé¨ User Interactions

### YeuCau: Role-based Sections

```
Employee user loads page
   ‚Üì
Sees 2 sections: "T√¥i g·ª≠i" + "C·∫ßn x·ª≠ l√Ω"
   ‚Üì
Manager user loads page
   ‚Üì
Sees 3 sections: +  "ƒêi·ªÅu ph·ªëi"
   ‚Üì
Admin user loads page
   ‚Üì
Sees 4 sections: + "Qu·∫£n l√Ω khoa"
```

### KPI: Cycle Change

```
User on KPIDashboardPage
   ‚Üì
Tap cycle selector dropdown
   ‚Üì
Select "Th√°ng 12/2025"
   ‚Üì
onChange(selectedCycle)
   ‚Üì
Re-fetch KPI data: getDanhGiaKPIs(nhanVienId, newCycleId)
   ‚Üì
Update PersonalKPIProgress + NhiemVuList
```

---

## ‚úÖ Acceptance Criteria

### YeuCauDashboardPage

- [ ] Page loads badge counts for all sections
- [ ] Sent section displays 3 status cards
- [ ] Need action section shows priority list (top 3)
- [ ] Manager section only visible if role = manager/admin
- [ ] Admin section only visible if role = admin
- [ ] Tapping section navigates to correct list page

### KPIDashboardPage

- [ ] Cycle selector loads available cycles
- [ ] Current cycle auto-selected on mount
- [ ] Personal progress card shows: score, approved count, pending count
- [ ] Nhi·ªám v·ª• list displays all routine duties with status
- [ ] Manager section only visible if role = manager/admin
- [ ] Changing cycle refreshes all data
- [ ] "T·ª± ƒë√°nh gi√°" button navigates to self-assessment page

---

**Next:** [Part 5 - Components & Navigation ‚Üí](./UI_UX_05_COMPONENTS_NAV.md)
